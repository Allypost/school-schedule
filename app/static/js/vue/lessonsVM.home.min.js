window.lessonsVM=new Vue({el:"#lessons",data:{lessons:[],loading:!0,error:!1,success:!1,btnInterval:null},methods:{getAttendingUrl:function(){return $(this.$el).attr("data-attending")},fetchLessons:function(){var n=this,t=n.getAttendingUrl();$.get(t).done(function(t){n.lessons=t.data,n.loading=!1})},getLessons:function(){var n=this.lessons,t={};for(var e in n)if(n.hasOwnProperty(e)){var s=n[e];t[s.id]={id:s.id,attending:!!s.attending}}return t},saveLessons:function(){var n=this,t=$("#lessons"),e=t.attr("action"),s=t.find('input[type="hidden"]:last'),o={key:s.attr("name"),token:s.attr("value")},r={lessons:this.getLessons()};r[o.key]=o.token,this.loading=!0,$.post(e,r).done(function(){n.btnStatus("success")}).fail(function(t){t=t.responseJSON||{errors:["Something went wrong"]},n.btnStatus("error");var e=t.errors;for(var s in e)e.hasOwnProperty(s)&&Materialize.toast(e[s],5e3,"status error")}).always(function(){n.loading=!1})},btnStatus:function(n,t){var e=this;e[n]=!0,window.clearInterval(e.btnInterval);var s=function(){e[n]=!1,(t=t||function(){})()};return t||(e.btnInterval=window.setTimeout(s,1500)),s}},mounted:function(){$(document).ready(function(){lessonsVM.fetchLessons()})}});